# System Fixes - September 2025

## üéØ **–û–±–∑–æ—Ä –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π**

–î–≤–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ Meet-Commit:

1. **–ó–∞–º–µ–Ω–∞ "System" –∑–∞–∫–∞–∑—á–∏–∫–∞ –Ω–∞ "Valya Dobrynin"**
2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ª–∏–ø–∞–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –≤ LLM –ø–∞—Ä—Å–∏–Ω–≥–µ**

---

## üîß **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: System ‚Üí Valya Dobrynin**

### **–ü—Ä–æ–±–ª–µ–º–∞**
- –í agenda —Å–∏—Å—Ç–µ–º–µ –ø–æ—è–≤–ª—è–ª—Å—è "System" –∫–∞–∫ –∑–∞–∫–∞–∑—á–∏–∫ –∑–∞–¥–∞—á
- "System" –ø–æ–ø–∞–¥–∞–ª –≤ —Ç–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö –ª—é–¥–µ–π –ø–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è
- –≠—Ç–æ –º–µ—à–∞–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –≤—ã–≥–ª—è–¥–µ–ª–æ –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å–∏—Å—Ç–µ–º—ã

### **–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã**
–í `app/core/commit_normalize.py` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `normalize_commits()`:
```python
# –ë–´–õ–û:
from_person = ["System"]  # Fallback –¥–ª—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑—á–∏–∫–æ–≤

# –°–¢–ê–õ–û:
from_person = ["Valya Dobrynin"]  # –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π fallback
```

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**
1. **`app/core/commit_normalize.py`** - —Å—Ç—Ä–æ–∫–∏ 442, 446:
   - –ó–∞–º–µ–Ω–∏–ª `["System"]` –Ω–∞ `["Valya Dobrynin"]` –≤ fallback –ª–æ–≥–∏–∫–µ

2. **`app/core/people_activity.py`** - —Å—Ç—Ä–æ–∫–∏ 126-131:
   - –î–æ–±–∞–≤–∏–ª —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–º–µ–Ω:
   ```python
   excluded_system_names = {"System", "Unknown", "Bot", "Auto", ""}
   
   for person, stats in people_stats.items():
       if person in excluded_system_names:
           continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∏–º–µ–Ω–∞
   ```

### **–†–µ–∑—É–ª—å—Ç–∞—Ç**
- ‚úÖ "System" –±–æ–ª—å—à–µ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ agenda –ø–æ–≤–µ—Å—Ç–∫–∞—Ö
- ‚úÖ –í—Å–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—á–∏–∫–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è "Valya Dobrynin"
- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ª—é–¥–µ–π –æ—á–∏—â–µ–Ω –æ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

---

## üîß **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –°–ª–∏–ø–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π**

### **–ü—Ä–æ–±–ª–µ–º–∞**
–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `/llm` –∫–æ–º–∞–Ω–¥—ã —Å —Ç–µ–∫—Å—Ç–æ–º —Ç–∏–ø–∞:
- "–ù–æ–¥–∞—Ä–∏ –∏ –õ–æ–º–ø–∞ —Å–¥–µ–ª–∞—é—Ç –ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—é"
- "–í–ª–∞–¥ –°–∫–ª—è–Ω–æ–≤, –°–µ—Ä–≥–µ–π –õ–æ–º–ø–∞ –ø–æ–¥–≥–æ—Ç–æ–≤—è—Ç –æ—Ç—á–µ—Ç"

**–†–µ–∑—É–ª—å—Ç–∞—Ç –±—ã–ª –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π:**
```
assignees: ["Nodari Kezua –ò Sergey Lompa"]  ‚ùå (–æ–¥–∏–Ω —Å–ª–∏—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç)
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```
assignees: ["Nodari Kezua", "Sergey Lompa"]  ‚úÖ (–¥–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–∞)
```

### **–ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã**
–í `app/core/llm_commit_parse.py` —Ñ—É–Ω–∫—Ü–∏—è `_apply_role_fallbacks()`:
```python
# –ë–´–õ–û:
assignee = llm_result.get("assignee") or user_name  # –°—Ç—Ä–æ–∫–∞
raw_assignees = [assignee] if assignee else []     # –°—Ç—Ä–æ–∫–∞ –≤ —Å–ø–∏—Å–æ–∫

# LLM –≤–æ–∑–≤—Ä–∞—â–∞–ª: "Vlad Sklyanov, Sergey Lompa"
# –ü–æ–ª—É—á–∞–ª–æ—Å—å: ["Vlad Sklyanov, Sergey Lompa"] ‚ùå
```

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**
1. **–ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `_split_names()`**:
   ```python
   def _split_names(names_string: str) -> list[str]:
       """–†–∞–∑–±–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–∫—É —Å –∏–º–µ–Ω–∞–º–∏ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞."""
       # –ó–∞–º–µ–Ω—è–µ–º —Å–æ—é–∑—ã –Ω–∞ –∑–∞–ø—è—Ç—ã–µ
       normalized = re.sub(r'\s+(–∏|and|with|&|\+)\s+', ', ', names_string, flags=re.IGNORECASE)
       # –†–∞–∑–±–∏–≤–∞–µ–º –ø–æ –∑–∞–ø—è—Ç—ã–º
       names = [name.strip() for name in normalized.split(',')]
       return [name for name in names if name]
   ```

2. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è `_apply_role_fallbacks()`**:
   ```python
   # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏: —Ä–∞–∑–±–∏–≤–∞–µ–º —Å—Ç—Ä–æ–∫—É –Ω–∞ —Å–ø–∏—Å–æ–∫
   assignee_raw = llm_result.get("assignee") or user_name
   assignees = _split_names(assignee_raw) if assignee_raw else [user_name]
   
   # Direction –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, –∫—Ç–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
   direction = "mine" if user_name in assignees else "theirs"
   
   return assignees, from_person, direction  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ø–∏—Å–æ–∫
   ```

3. **–û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è `_build_full_commit()`**:
   ```python
   # –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∏
   def _build_full_commit(llm_result: dict, user_name: str, assignees: list[str], ...):
       normalized_assignees = normalize_assignees(assignees, [])
   ```

### **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π**
- **–ó–∞–ø—è—Ç—ã–µ:** "Alice, Bob, Charlie"
- **–†—É—Å—Å–∫–∏–µ —Å–æ—é–∑—ã:** "–ù–æ–¥–∞—Ä–∏ –∏ –õ–æ–º–ø–∞"
- **–ê–Ω–≥–ª–∏–π—Å–∫–∏–µ —Å–æ—é–∑—ã:** "John and Jane", "Alice with Bob"
- **–°–∏–º–≤–æ–ª—ã:** "Tom & Jerry", "One + Two"
- **–°–º–µ—à–∞–Ω–Ω—ã–µ:** "Alice, Bob –∏ Charlie and Dave"

### **–†–µ–∑—É–ª—å—Ç–∞—Ç**
- ‚úÖ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–∑–¥–µ–ª—è—é—Ç—Å—è
- ‚úÖ –ö–∞–∂–¥—ã–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ Notion
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä—É—Å—Å–∫–∏—Ö –∏ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–æ—é–∑–æ–≤
- ‚úÖ –õ–æ–≥–∏–∫–∞ direction –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏

---

## üß™ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**

### **–ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã**
–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `tests/test_system_fixes.py` —Å 14 —Ç–µ—Å—Ç–∞–º–∏:

#### **System Fallback Fix (3 —Ç–µ—Å—Ç–∞)**
- ‚úÖ `test_system_replaced_in_mine_commits`
- ‚úÖ `test_system_replaced_in_theirs_commits` 
- ‚úÖ `test_system_excluded_from_people_activity`

#### **Assignee Splitting Fix (9 —Ç–µ—Å—Ç–æ–≤)**
- ‚úÖ `test_split_names_comma_separated`
- ‚úÖ `test_split_names_russian_conjunction`
- ‚úÖ `test_split_names_english_conjunction`
- ‚úÖ `test_split_names_mixed_separators`
- ‚úÖ `test_apply_role_fallbacks_multiple_assignees`
- ‚úÖ `test_parse_commit_text_multiple_assignees`
- ‚úÖ –ò –¥—Ä—É–≥–∏–µ –≥—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

#### **Integration Tests (2 —Ç–µ—Å—Ç–∞)**
- ‚úÖ `test_no_system_in_llm_commits`
- ‚úÖ `test_realistic_scenario`

### **–û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ 8 —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤ –≤ `tests/test_llm_commit_parse.py`:
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ–¥ –Ω–æ–≤—É—é —Å–∏–≥–Ω–∞—Ç—É—Ä—É `_apply_role_fallbacks()` (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫)
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ–¥ –Ω–æ–≤—É—é —Å–∏–≥–Ω–∞—Ç—É—Ä—É `_build_full_commit()` (–ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–ø–∏—Å–æ–∫)

### **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**
```bash
============================= test session starts ==============================
90 passed in 2.01s
============================= 90 passed, 0 failed ==============================
```

---

## üìä **–í–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É**

### **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–π**
- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –ù–∏–∫–∞–∫–∏–µ API –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å
- ‚úÖ –î–∞–Ω–Ω—ã–µ –≤ Notion –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã

### **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- ‚û°Ô∏è –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚û°Ô∏è –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è `_split_names()` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞ O(n) –≤—Ä–µ–º–µ–Ω–∏
- ‚û°Ô∏è –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–º–µ–Ω - O(1) –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ hash set

### **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç**
- üéØ **–õ—É—á—à–µ:** –ë–æ–ª—å—à–µ –Ω–µ—Ç "System" –≤ agenda –ø–æ–≤–µ—Å—Ç–∫–∞—Ö
- üéØ **–õ—É—á—à–µ:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ Notion
- üéØ **–õ—É—á—à–µ:** –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –ª—é–¥–µ–π –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

---

## üöÄ **Deployment**

### **–î–∞—Ç–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è**
29 —Å–µ–Ω—Ç—è–±—Ä—è 2025

### **–í–µ—Ä—Å–∏—è**
Commit: [hash] - "Fix System fallback and assignee splitting in LLM parsing"

### **–û—Ç–∫–∞—Ç**
–í —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º –º–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è:
1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `["System"]` –≤ `commit_normalize.py`
2. –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É `_apply_role_fallbacks()` –≤–æ–∑–≤—Ä–∞—â–∞—é—â—É—é —Å—Ç—Ä–æ–∫—É
3. –£–±—Ä–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–º–µ–Ω –∏–∑ `people_activity.py`

### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
- üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ "System" –≤ –ª–æ–≥–∞—Ö
- üìä –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π –≤ Notion
- üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å agenda –∫–Ω–æ–ø–∫–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∏–º–µ–Ω

---

## üéâ **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–û–±–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å–ø–µ—à–Ω–æ —Ä–µ—à–µ–Ω—ã:

1. **"System" –∑–∞–∫–∞–∑—á–∏–∫** ‚Üí **"Valya Dobrynin"** (–ø–æ–Ω—è—Ç–Ω—ã–π fallback)
2. **–°–ª–∏–ø–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π** ‚Üí **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ—é–∑–æ–≤)

–°–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–ª–∞ –±–æ–ª–µ–µ –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–π –∏ —É–¥–æ–±–Ω–æ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞.

**–°—Ç–∞—Ç—É—Å: ‚úÖ COMPLETED**

